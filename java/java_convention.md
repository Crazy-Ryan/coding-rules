# Java 编程规范

本教程参照了 Google Java 的编程风格

## 1. 源文件

### 1.1 基础
- 源文件以其最顶层的类名来命名，大小写敏感，文件扩展名为.java。
- 源文件编码格式为UTF-8。
- package语句不换行。
- import不要使用通配符，即不要出现类似这样的import语句：`import java.util.*;`
- import语句不换行

### 1.2 类声明
- 只有一个顶级类声明，每个顶级类都在一个与它同名的源文件中。
- 类的成员顺序对易学性有很大的影响，每个类应该以某种逻辑去排序它的成员，维护者应该要能解释这种排序逻辑。
- 当一个类有多个构造函数，或是多个同名方法，这些重载函数/方法应该按顺序出现在一起，中间不要放进其它函数/方法。

## 2. 格式

### 2.1 大括号
- 大括号与if, else, for, do, while语句一起使用，即使只有一条语句(或是空)，也应该把大括号写上。
- 对于非空块和块状结构，大括号遵循K & R 风格，即
    1. 左大括号前不换行，左大括号后换行
    2. 右大括号前换行
    3. 如果右大括号是一个语句、函数体或类的终止，则右大括号后换行; 否则不换行。例如，如果右大括号后面是else或逗号，则不换行。
  
    示例：
    ```
    return new MyClass() {
        @Override 
        public void method() {
            if (condition()) {
                try {
                    something();
                } catch (ProblemException e) {
                    recover();
                }
            }
        }
    };
    ```
- 对于空块，可以用简洁版本

    一个空的块状结构里什么也不包含，大括号可以简洁地写成{}，不需要换行。
    
    例外：如果它是一个多块语句的一部分(if/else 或 try/catch/finally) ，即使大括号内没内容，右大括号也要换行。

    示例：
    ```
    void doNothing() {}
    ```

### 2.2 列限制

一个项目可以选择一行80个字符或100个字符的列限制，除了下述例外，任何一行如果超过这个字符数限制，必须自动换行。

自动换行的基本准则是：更倾向于在更高的语法级别处断开。
1. 如果在非赋值运算符处断开，那么在该符号前断开(比如+，它将位于下一行)。
2. 如果在赋值运算符处断开，通常的做法是在该符号后断开(比如=，它与前面的内容留在同一行)。这条规则也适用于foreach语句中的分号。
3. 方法名或构造函数名与左括号留在同一行。
4. 逗号(,)与其前面的内容留在同一行。

自动换行时，第一行后的每一行至少比第一行多缩进4个空格。当存在连续自动换行时，缩进可能会多缩进不只4个空格(语法元素存在多级时)。
一般而言，两个连续行使用相同的缩进当且仅当它们开始于同级语法元素。

### 2.3 空白
- 垂直空白
    
    以下情况需要使用一个空行：
    1. 类内连续的成员之间：字段，构造函数，方法，嵌套类，静态初始化块，实例初始化块。
    2. 两个连续字段之间的空行是可选的，用于字段的空行主要用来对字段进行逻辑分组
    3. 函数体内，语句的逻辑分组间使用空行。
    4. 类内的第一个成员前或最后一个成员后的空行是可选的(既不鼓励也不反对这样做，视个人喜好而定)。
    
    多个连续的空行是允许的，但没有必要这样做，也不鼓励这样做。
    
- 水平空白

    单个ASCII空格出现在以下几个地方：
    1. 分隔任何保留字与紧随其后的左括号(()(如if, for catch等)。
    2. 分隔任何保留字与其前面的右大括号(})(如else, catch)。
    3. 在任何左大括号前({)。
    4. 在任何二元或三元运算符的两侧。
    5. 在, : ;及右括号())后
    6. 如果在一条语句后做注释，则双斜杠(//)两边都要空格。这里可以允许多个空格，但没有必要。
    7. 类型和变量之间：List list。
    8. 数组初始化中，大括号内的空格是可选的，即new int[] {5, 6}和new int[] { 5, 6 }都是可以的。

### 其它
- 每个语句后要换行。
- 每当开始一个新的块，缩进增加4个空格，当块结束时，缩进返回先前的缩进级别。缩进级别适用于代码和注释。
- 用小括号来显式限定运算符的优先顺序，除非去掉小括号不会使代码被误解，或让代码更易于阅读。

## 3. 语法结构

### 3.1 枚举类

枚举常量间用逗号隔开，换行可选。

没有方法和文档的枚举类可写成数组初始化的格式：
```
    private enum Suit { CLUBS, HEARTS, SPADES, DIAMONDS }
```

### 3.2 变量声明

- 每次只声明一个变量

    不要使用组合声明，比如`int a, b;`。
- 需要时才声明，并尽快进行初始化

    不要在一个代码块的开头把局部变量一次性都声明了，而是在第一次需要使用它时才声明。 
    局部变量在声明时最好就进行初始化，或者声明后尽快进行初始化。

### 3.3 数组

数组初始化，可写成块状结构
```
new int[] {
  0, 1, 2, 3 
}

new int[] {
  0,
  1,
  2,
  3
}

new int[] {
  0, 1,
  2, 3
}

new int[]{0, 1, 2, 3}
```

### 3.4 switch语句

- 缩进

    switch块中的内容缩进为4个空格，每个switch标签后新起一行，再缩进4个空格，写下一条或多条语句。
- 注释

    在一个switch块内，每个语句组要么通过break, continue, return或抛出异常来终止，要么通过一条注释来说明程序将继续执行到下一个语句组， 
    任何能表达这个意思的注释都是OK的(典型的是用`// fall through`)。这个特殊的注释并不需要在最后一个语句组(一般是`default`)中出现。
    
    示例：
    ```
        switch (input) {
          case 1:
          case 2:
            prepareOneOrTwo();
            // fall through
          case 3:
            handleOneTwoOrThree();
            break;
          default:
            handleLargeNumber(input);
        }
    ```
 -  default
 
    每个switch语句都包含一个default语句组，即使它什么代码也不包含。
    
### 3.5 注解

注解紧跟在文档块后面，应用于类、字段、方法和构造函数，一个注解独占一行。这些换行不属于自动换行，因此缩进级别不变。

例如：
```
    @Override
    @Nullable
    public String getNameIfPresent() { ... }
```

### 3.6 注释

块注释与其周围的代码在同一缩进级别。它们可以是`/* ... */`风格，也可以是`// ...`风格。对于多行的`/* ... */`注释，后续行必须从`*`开始， 并且与前一行的`*`对齐。

以下示例注释都是OK的：
```
/*
 * This is                   
 * okay.                     
 */

/* Or you can
 * even do this. */

// And so  
// is this.
```

### 3.7 修饰符

类和成员的modifiers如果存在，则按Java语言规范中推荐的顺序出现：
```
public protected private abstract static final transient volatile synchronized native strictfp
```




